function [errh, solution] = RungeKutta89(f,y,t,step)
%UNTITLED Summary(:,1) of this function goes here
%   Detailed explanation goes here
    h = step;
    
    rt6 = sqrt(6.0);

    a1 = 0.0;    
    a2 = 1.0 / 12.0;    
    a3 = 1.0 / 9.0;
    a4 = 1.0 / 6.0;
    a5 = (2.0 + 2.0 * rt6) / 15.0;    
    a6 = (6.0 + rt6) / 15.0;
    a7 = (6.0 - rt6) / 15.0;    
    a8 = 2.0 / 3.0;    
    a9 = 1.0 / 2.0;    
    a10 = 1.0 / 3.0;    
    a11 = 1.0 / 4.0;    
    a12 = 4.0 / 3.0;    
    a13 = 5.0 / 6.0;    
    a14 = 1.0;    
    a15 = 1.0 / 6.0;    
    a16 = 1.0;    


    b11 =  0.0;

    b21 = 1.0 / 12.0;
    b22 = 0.0;

    b31 = 1.0 / 27.0;
    b32 = 2.0 / 27.0;
    b33 = 0.0;

    b41 = 1.0 / 24.0;
    b42 = 0.0;
    b43 = 1.0 / 8.0;
    b44 = 0.0;

    b51 = (4.0 + 94.0 * rt6) / 375.0;
    b52 = 0.0;
    b53 = (-94.0 - 84.0 * rt6) / 125.0;
    b54 =  (328.0 + 208.0 * rt6) / 375.0;
    b55 =   0.0;

    b61 = (9.0 - rt6) / 150.0;
    b62 = 0.0;
    b63 = 0.0;
    b64 = (312.0 + 32.0 * rt6) / 1425.0;
    b65 = (69.0 + 29.0 * rt6) / 570.0;
    b66 = 0.0;

    b71 = (927.0 - 347.0 * rt6) / 1250.0;
    b72 = 0.0;
    b73= 0.0;
    b74 = (-16248.0 + 7328.0 * rt6) / 9375.0;
    b75 = (-489.0 + 179.0 * rt6) / 3750.0;
    b76 = (14268.0 - 5798.0 * rt6) / 9375.0;
    b77 = 0.0;

    b81 = 2.0 / 27.0;
    b82 = 0.0;
    b83 = 0.0;
    b84 = 0.0;
    b85 = 0.0;
    b86 = (16.0 - rt6) / 54.0;
    b87 = (16.0 + rt6) / 54.0;
    b88 = 0.0;

    b91 = 19.0 /256.0;
    b92 = 0.0;
    b93 = 0.0;
    b94 = 0.0;
    b95 = 0.0;
    b96 = (118.0 - 23.0 * rt6) / 512.0;
    b97 = (118.0 + 23.0 * rt6) / 512.0;
    b98 = -9.0 / 256.0;
    b99 = 0.0;

    b10_1 = 11.0 / 144.0;
    b10_2 = 0.0;
    b10_3 = 0.0;
    b10_4 = 0.0;
    b10_5 = 0.0;
    b10_6 = (266.0 - rt6) / 864.0;
    b10_7 = (266.0 + rt6) / 864.0;
    b10_8 = -1.0 / 16.0;
    b10_9 = -8.0 / 27.0;
    b10_10 = 0.0;

    b11_1 = (5034.0 - 271.0 * rt6) / 61440.0;
    b11_2 = 0.0;
    b11_3 = 0.0;
    b11_4 = 0.0;
    b11_5 = 0.0;
    b11_6 = 0.0;
    b11_7 = (7859.0 - 1626.0 * rt6) / 10240.0;
    b11_8 = (-2232.0 + 813.0 * rt6) / 20480.0;
    b11_9 = (-594.0 + 271.0 * rt6) / 960.0;
    b11_10 = (657.0 - 813.0 * rt6) / 5120.0;
    b11_11 = 0.0;

    b12_1 = (5996.0 - 3794.0 * rt6) / 405.0;
    b12_2 = 0.0;
    b12_3 = 0.0;
    b12_4 = 0.0;
    b12_5 = 0.0;
    b12_6 = (-4342.0 - 338.0 * rt6) / 9.0;
    b12_7 = (154922.0 - 40458.0 * rt6) / 135.0;
    b12_8 = (-4176.0 + 3794.0 * rt6) / 45.0;
    b12_9 = (-340864.0 + 242816.0 * rt6) / 405.0;
    b12_10 = (26304.0 - 15176.0 * rt6) / 45.0;
    b12_11 = -26624.0 / 81.0;
    b12_12 = 0.0;

    b13_1 = (3793.0 + 2168.0 * rt6) / 103680.0;
    b13_2 = 0.0;
    b13_3 = 0.0;
    b13_4 = 0.0;
    b13_5 = 0.0;
    b13_6 = (4042.0 + 2263.0 * rt6) / 13824.0;
    b13_7 = (-231278.0 + 40717.0 * rt6) / 69120.0;
    b13_8 = (7947.0 - 2168.0 * rt6) / 11520.0;
    b13_9 = (1048.0 - 542.0 * rt6) / 405.0;
    b13_10 = (-1383.0 + 542.0 * rt6) / 720.0;
    b13_11 = 2624.0 / 1053.0;
    b13_12 = 3.0 / 1664.0;
    b13_13 = 0.0;

    b14_1 = -137.0 / 1296.0;
    b14_2 = 0.0;
    b14_3 = 0.0;
    b14_4 = 0.0;
    b14_5 = 0.0;
    b14_6 = (5642.0 - 337.0 * rt6) / 864.0;
    b14_7 = (5642.0 + 337.0 * rt6) / 864.0;
    b14_8 = -299.0 / 48.0;
    b14_9 = 184.0 / 81.0;
    b14_10 = -44.0 / 9.0;
    b14_11 = -5120.0 / 1053.0;
    b14_12 = -11.0 / 468.0;
    b14_13 = 16.0 / 9.0;
    b14_14 = 0.0;

    b15_1 = (33617.0 - 2168.0 * rt6) / 518400.0;
    b15_2 = 0.0;
    b15_3 = 0.0;
    b15_4 = 0.0;
    b15_5 = 0.0;
    b15_6 = (-3846.0 + 31.0 * rt6) / 13824.0;
    b15_7 = (155338.0 - 52807.0 * rt6) / 345600.0;
    b15_8 = (-12537.0 + 2168.0 * rt6) / 57600.0;
    b15_9 = (92.0 + 542.0 * rt6) / 2025.0;
    b15_10 = (-1797.0 - 542.0 * rt6) / 3600.0;
    b15_11 = 320.0 / 567.0;
    b15_12 = -1.0 / 1920.0;
    b15_13 = 4.0 / 105.0;
    b15_14 = 0.0;
    b15_15 = 0.0;

    b16_1 = (-36487.0 - 30352.0 * rt6) / 279600.0;
    b16_2 = 0.0;
    b16_3 = 0.0;
    b16_4 = 0.0;
    b16_5 = 0.0;
    b16_6 = (-29666.0 - 4499.0 * rt6) / 7456.0;
    b16_7 = (2779182.0 - 615973.0 * rt6) / 186400.0;
    b16_8 = (-94329.0 + 91056.0 * rt6) / 93200.0;
    b16_9 = (-232192.0 + 121408.0 * rt6) / 17475.0;
    b16_10 = (101226.0 - 22764.0 * rt6) / 5825.0;
    b16_11 = -169984.0 / 9087.0;
    b16_12 = -87.0 / 30290.0;
    b16_13 = 492.0 / 1165.0;
    b16_14 = 0.0;
    b16_15 = 1260.0 / 233.0;
    b16_16 = 0.0;

    c1 = 23.0 / 525.0;
    c2 = 0.0;
    c3 = 0.0;
    c4 = 0.0;
    c5 = 0.0;
    c6 = 0.0;
    c7 = 0.0;
    c8 = 171.0 / 1400.0;
    c9 = 86.0 / 525.0;
    c10 = 93.0 / 280.0;
    c11 = -2048.0 / 6825.0;
    c12 = -3.0 / 18200.0;
    c13 = 39.0 / 175.0;
    c14 = 0.0;
    c15 = 9.0 / 25.0;
    c16 = 233.0 / 4200.0;

    e1 = -7.0 / 400.0;
    e2 = 0.0;
    e3 = 0.0;
    e4 = 0.0;
    e5 = 0.0;
    e6 = 0.0;
    e7 = 0.0;
    e8 = 63.0 / 200.0;
    e9 = -14.0 / 25.0;
    e10 = 21.0 / 20.0;
    e11 = -1024.0 / 975.0;
    e12 = -21.0 / 36400.0;
    e13 = -3.0 / 25.0;
    e14 = -9.0 / 280.0;
    e15 = 9.0 / 25.0;
    e16 = 233.0 / 4200.0;
    
   k1 = f(t+a1*h,y(:,1));                                                   
   k2 = f(t+a2*h, y(:,1) + h*b21*k1);   %b21*k1 ; b21 = 1/12                               
   k3 = f(t+a3*h, y(:,1)+ h*(b31*k1 + b32*k2));                           
   k4 = f(t+a4*h, y(:,1) + h * (b41*k1 + b42*k2 + b43*k3));
   k5 = f(t+a5*h, y(:,1) + h * (b51*k1 + b52*k2 + b53*k3 + b54*k4));
   k6 = f(t+a6*h, y(:,1) + h * (b61*k1 + b62*k2 + b63*k3 + b64*k4 + b65*k5));
   k7 = f(t+a7*h, y(:,1) + h * (b71*k1 + b72*k2 + b73*k3 + b74*k4 + b75*k5 + b76*k6));
   k8 = f(t+a8*h, y(:,1) + h * (b81*k1 + b82*k2 + b83*k3 + b84*k4 + b85*k5 + b86*k6 + b87*k7));
   k9 = f(t+a9*h, y(:,1) + h * (b91*k1 + b92*k2 + b93*k3 + b94*k4 + b95*k5 + b96*k6 + b97*k7 + b98*k8));
   k10 = f(t+a10*h, y(:,1) + h * (b10_1*k1 + b10_2*k2 + b10_3*k3 + b10_4*k4 + b10_5*k5 + b10_6*k6 + b10_7*k7 + b10_8*k8 + b10_9*k9));
   k11 = f(t+a11*h, y(:,1) + h * (b11_1*k1 + b11_7*k7 + b11_8*k8 + b11_9*k9 + b11_10 * k10));
   k12 = f(t+a12*h, y(:,1) + h * (b12_1*k1 + b12_6*k6 + b12_7*k7 + b12_8*k8 + b12_9*k9 + b12_10 * k10 + b12_11 * k11));
   k13 = f(t+a13*h, y(:,1) + h * (b13_1*k1 + b13_6*k6 + b13_7*k7 + b13_8*k8 + b13_9*k9 + b13_10*k10 + b13_11*k11 + b13_12*k12));
   k14 = f(t+a14*h, y(:,1) + h * (b14_1*k1 + b14_6*k6 + b14_7*k7 + b14_8*k8 + b14_9*k9 + b14_10*k10 + b14_11*k11 + b14_12*k12 + b14_13*k13));
   k15 = f(t+a15*h, y(:,1) + h * (b15_1*k1 + b15_6*k6 + b15_7*k7 + b15_8*k8 + b15_9*k9 + b15_10*k10 + b15_11*k11 + b15_12*k12 + b15_13*k13));
   k16 = f(t+a16*h, y(:,1) + h * (b16_1*k1 + b16_6*k6 + b16_7*k7 + b16_8*k8 + b16_9*k9 + b16_10*k10 + b16_11*k11 + b16_12*k12 + b16_13*k13 + b16_15*k15));

   solution = y(:,1) +  h * (c1 * k1 + c2*k2 + c3*k3 + c4*k4 + c5*k5 + c6*k6 + c7*k7 + c8 * k8 + c9 * k9 + c10 * k10 + c11 * k11 + c12 * k12 + c13 * k13 + c14 * k14 + c15*k15 + c16*k16);
   % that is the candidate state
   
   % now error estimation (vector) 6 dim
   errh = e1*k1 + e8*k8 + e9*k9 + e10*k10 + e11*k11 + e12*k12 + e13*k13 + e14*k14 + e15*k15 + e16*k16;
   
   
end

